<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pedido Bio-Fix</title>
<style>
body { font-family: Arial, sans-serif; padding: 15px; background: #f4f4f4; }
h2,h3{text-align:center;margin-bottom:10px;}
.section{background:#fff;padding:15px;border-radius:10px;margin-bottom:20px;display:none;}
.item{display:flex;align-items:center;gap:10px;margin-bottom:10px;flex-wrap:wrap;}
select,input{padding:5px;flex:1;}
button{background:#25d366;color:#fff;border:none;padding:10px;border-radius:8px;cursor:pointer;margin-top:10px;}
button:hover{background:#1ebe5c;}
.nota-seguridad{font-size:12px;color:#555;text-align:center;margin-top:10px;}
#resumenPedido{white-space:pre-line; background:#eee; padding:10px; border-radius:8px;}
input[type=text], input[type=number], select {width:100%; margin-bottom:10px;}
</style>
</head>
<body>
<h2>Formulario de Pedido Bio-Fix</h2>

<!-- SECCIÓN 1: DATOS ODONTÓLOGO -->
<div class="section" id="datos-section" style="display:block;">
<h3>Datos del odontólogo</h3>
<input type="text" placeholder="Nombre" id="nombre">
<input type="text" placeholder="Apellido" id="apellido">
<input type="text" placeholder="DNI" id="dni">
<input type="text" placeholder="Matrícula profesional" id="matricula">
<select id="provincia">
<option value="">Seleccionar provincia</option>
<option>Buenos Aires</option>
<option>Córdoba</option>
<option>Santa Fe</option>
<option>Mendoza</option>
<option>Entre Ríos</option>
</select>
<input type="text" placeholder="Localidad" id="localidad">
<button id="btnSiguienteDatos" style="display:none;">Siguiente</button>
</div>

<!-- SECCIÓN 2: CATEGORÍAS -->
<div class="section" id="categorias-section">
<h3>Selecciona categoría</h3>
<button onclick="mostrarProductos('Implantes')">Implantes</button>
<button onclick="mostrarProductos('Componentes Analógicos')">Componentes Analógicos</button>
<button onclick="mostrarProductos('Herramental')">Herramental</button>
</div>

<!-- SECCIÓN 3: PRODUCTOS -->
<div class="section" id="productos-section">
<h3 id="tituloProductos">Productos</h3>
<div id="productos-list"></div>
<button onclick="agregarProducto()">+ Agregar Producto</button>
<button onclick="mostrarResumen()">Ver Pedido</button>
</div>

<!-- SECCIÓN 4: RESUMEN -->
<div class="section" id="resumen-section">
<h3>Resumen del Pedido</h3>
<div id="resumenPedido"></div>
<button onclick="enviarPedido()">Enviar por WhatsApp</button>
</div>

<p class="nota-seguridad">🔒 Tu información se procesa de forma segura.</p>

<script>
// CAMPOS DATOS ODONTÓLOGO
const campos = ["nombre","apellido","dni","matricula","provincia","localidad"];
const btnSiguienteDatos = document.getElementById("btnSiguienteDatos");
campos.forEach(id => {
  document.getElementById(id).addEventListener("input", ()=>{
    const completos = campos.every(c=>document.getElementById(c).value.trim()!=="");
    btnSiguienteDatos.style.display = completos ? "block" : "none";
  });
});
btnSiguienteDatos.addEventListener("click", ()=>{
  document.getElementById("datos-section").style.display="none";
  document.getElementById("categorias-section").style.display="block";
});

// CATALOGO COMPLETO
const catalogo = {
  "Implantes": {
    "Hexágono Interno": ["Ø3.0 x 6.5 mm","Ø3.0 x 8 mm","Ø3.0 x 10 mm","Ø3.0 x 11.5 mm","Ø3.0 x 13 mm","Ø3.0 x 16 mm",
                         "Ø3.75 x 6.5 mm","Ø3.75 x 8 mm","Ø3.75 x 10 mm","Ø3.75 x 11.5 mm","Ø3.75 x 13 mm","Ø3.75 x 16 mm",
                         "Ø4.2 x 6.5 mm","Ø4.2 x 8 mm","Ø4.2 x 10 mm","Ø4.2 x 11.5 mm","Ø4.2 x 13 mm","Ø4.2 x 16 mm",
                         "Ø5.0 x 6.5 mm","Ø5.0 x 8 mm","Ø5.0 x 10 mm","Ø5.0 x 11.5 mm","Ø5.0 x 13 mm","Ø5.0 x 16 mm"],
    "Hexágono Externo": {"Ø3.30 (Plataforma Ø3.4)": ["8.5 mm","10 mm","11.5 mm","13 mm","15 mm"],
                         "Ø3.75 (Plataforma Ø4.1)": ["8.5 mm","10 mm","11.5 mm","13 mm","15 mm"],
                         "Ø4.0 (Plataforma Ø4.1)": ["6 mm","8.5 mm","10 mm","11.5 mm","13 mm","15 mm"],
                         "Ø5.0 (Plataforma Ø5.0)": ["8.5 mm","10 mm","11.5 mm","13 mm","15 mm"]},
    "Cono Morse": ["Ø3.5 x 11.5 mm","Ø4.0 x 13 mm"],
    "Monopieza": ["Ø3.0 x 10 mm","Ø3.5 x 13 mm"],
    "Monopieza Basal": ["Ø3.5 x 10 mm","Ø4.0 x 12 mm"],
    "Compresivo Multiunit": ["Ø3.75 x 10 mm","Ø4.0 x 13 mm"],
    "Minipilares": {"Hexágono Interno":["H1","H2","H3","H4","H5"],
                    "Hexágono Externo":["H1","H2","H3","H4","H5"],
                    "Cono Morse":["H0.8","H1.5","H2.5","H3.5","H4.5","H5.5"]}
  },
  "Componentes Analógicos": {
    "Hexágono Interno": {
      "Tapa de cicatrización":["H1","H2","H3","H4"],
      "Transfer cubeta":["Abierta","Cerrada"],
      "Pilar recto c/tornillo":["H1","H2","H3","H4"],
      "Pilar angulado c/tornillo":["15°","25°"],
      "Análogo de Titanio":[],
      "Ball attached y cazoleta c/o´ring":["H1","H2","H3","H4"],
      "Cazoleta c/o´ring":[],
      "Ucla calcinable rotacional c/tornillo":[],
      "Ucla calcinable anti-rotacional c/tornillo":[],
      "Tornillo protésico hexagonal":[],
      "Tornillo protésico cuadrado":[]
    },
    "Hexágono Externo": {
      "Tapa de cicatrización":["H1","H2","H3","H4"],
      "Transfer cubeta":["Abierta","Cerrada"],
      "Pilar recto c/tornillo":["H1","H2","H3","H4"],
      "Pilar angulado c/tornillo":["15°","25°"],
      "Análogo de Titanio":[],
      "Ball attached y cazoleta c/o´ring":["H1","H2","H3","H4"],
      "Cazoleta c/o´ring":[],
      "Ucla calcinable rotacional c/tornillo":[],
      "Ucla calcinable anti-rotacional c/tornillo":[],
      "Tornillo protésico hexagonal":[],
      "Tornillo protésico cuadrado":[],
      "Minipilar angulado + llave transportadora + tornillo":["H1","H2","H3","H4"]
    },
    "Multiunit": {
      "Pilar rotacional c/microtornillo":[],
      "Pilar antirrotacional c/microtornillo":[],
      "Ucla calcinable rotacional c/microtornillo":[],
      "Análogo":[],
      "Tapón cicatrizal plástico c/microtornillo":[],
      "Transfer cubeta abierta c/microtornillo":[],
      "Transfer cubeta cerrada c/microtornillo":[]
    }
  },
  "Herramental": [
    "Fresa Lanza","Fresa Lanza Guiada","Fresa Helicoidal","Expansor de hueso (Kit de 3 unidades)",
    "Torquímetro dinamométrico","Mango Rígido(Punta de 4x4) para expansor óseo","Extractor de raíz residual",
    "Destornillador para torquímetro","Destornillador Digital","Llave conectora Monopieza para torquímetro",
    "Llave CMU conectora para torquímetro","Mango Rígido para Angulación del Pilar MP","Llave digital para multiunit",
    "Driver Retráctil","Anilla Cirugía Guiada","Conector para torquímetro de implante CMHI",
    "Prolongador de Fresa","Prolongador 4x4","Punch","Caja organizadora de Instrumental metálica -Apta estufa y autoclave (Vacía)",
    "Caja quirúrgica Premium- Completa con instrumental (Apta autoclave)","Caja quirúrgica de Cirugía Guiada Bio-Fix",
    "Kit de fresas de condensación/compactación"
  ]
};

let categoriaActual="";
function mostrarProductos(cat){
  categoriaActual=cat;
  document.getElementById("categorias-section").style.display="none";
  document.getElementById("productos-section").style.display="block";
  document.getElementById("tituloProductos").textContent=cat;
  document.getElementById("productos-list").innerHTML="";
}

// Aquí agregamos la lógica de agregar productos según categoría
function agregarProducto(){
  const div = document.createElement("div");
  div.classList.add("item");

  if(categoriaActual==="Implantes"){
    // Código de implantes como antes...
  }

  if(categoriaActual==="Componentes Analógicos"){
    const selectSistema=document.createElement("select");
    selectSistema.innerHTML="<option value=''>Seleccionar sistema</option>";
    for(let s in catalogo["Componentes Analógicos"]) selectSistema.innerHTML+=`<option value="${s}">${s}</option>`;
    
    const selectProducto=document.createElement("select");
    selectProducto.innerHTML="<option value=''>Seleccionar producto</option>";
    
    const selectAltura=document.createElement("select");
    selectAltura.innerHTML="<option value=''>Seleccionar altura/opción</option>";
    selectAltura.style.display="none";

    const inputCantidad=document.createElement("input");
    inputCantidad.type="number";
    inputCantidad.placeholder="Cantidad";
    inputCantidad.min=1;

    selectSistema.addEventListener("change", ()=>{
      selectProducto.innerHTML="<option value=''>Seleccionar producto</option>";
      selectAltura.innerHTML="<option value=''>Seleccionar altura/opción</option>";
      selectAltura.style.display="none";
      const productos = catalogo["Componentes Analógicos"][selectSistema.value];
      for(let p in productos) selectProducto.innerHTML+=`<option value="${p}">${p}</option>`;
    });

    selectProducto.addEventListener("change", ()=>{
      selectAltura.innerHTML="<option value=''>Seleccionar altura/opción</option>";
      const sis = selectSistema.value;
      const prod = selectProducto.value;
      if(catalogo["Componentes Analógicos"][sis][prod].length>0){
        selectAltura.style.display="inline-block";
        catalogo["Componentes Analógicos"][sis][prod].forEach(a=>{
          selectAltura.innerHTML+=`<option value="${a}">${a}</option>`;
        });
      }else selectAltura.style.display="none";
    });

    div.appendChild(selectSistema);
    div.appendChild(selectProducto);
    div.appendChild(selectAltura);
    div.appendChild(inputCantidad);
  }

  if(categoriaActual==="Herramental"){
    const selectProducto=document.createElement("select");
    selectProducto.innerHTML="<option value=''>Seleccionar producto</option>";
    catalogo.Herramental.forEach(p=> selectProducto.innerHTML+=`<option value="${p}">${p}</option>`);
    const inputCantidad=document.createElement("input");
    inputCantidad.type="number";
    inputCantidad.placeholder="Cantidad";
    inputCantidad.min=1;
    div.appendChild(selectProducto);
    div.appendChild(inputCantidad);
  }

  document.getElementById("productos-list").appendChild(div);
}

// Resumen y envío
function mostrarResumen(){
  const resumenDiv=document.getElementById("resumenPedido");
  let texto="";
  campos.forEach(c=>{texto+=`${c.toUpperCase()}: ${document.getElementById(c).value}\n`;});
  document.querySelectorAll("#productos-list .item").forEach(item=>{
    const selects=item.querySelectorAll("select");
    const inputs=item.querySelectorAll("input");
    let linea="";
    if(categoriaActual==="Componentes Analógicos"){
      const sis=selects[0].value;
      const prod=selects[1].value;
      const alt=selects[2].value;
      const cant=inputs[0].value;
      if(sis && prod && cant) linea=`🦷 ${sis} - ${prod}${alt? " - "+alt:""} x${cant}`;
    }
    if(categoriaActual==="Herramental"){
      const prod=selects[0].value;
      const cant=inputs[0].value;
      if(prod && cant) linea=`🛠️ ${prod} x${cant}`;
    }
    texto+=linea? linea+"\n":"";
  });
  resumenDiv.textContent=texto;
  document.getElementById("productos-section").style.display="none";
  document.getElementById("resumen-section").style.display="block";
}

function enviarPedido(){
  const mensaje=document.getElementById("resumenPedido").textContent;
  const vendedor="5491123456789";
  window.open("https://wa.me/"+vendedor+"?text="+encodeURIComponent(mensaje), "_blank");
}
</script>
</body>
</html>
