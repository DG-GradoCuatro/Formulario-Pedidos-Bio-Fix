<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pedido Bio-Fix</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 15px; background: #f4f4f4; }
    h2 { text-align: center; }
    .section { background: #fff; padding: 15px; border-radius: 10px; margin-bottom: 20px; }
    .item { display: flex; align-items: center; gap: 10px; margin-bottom: 10px; flex-wrap: wrap; }
    select, input { padding: 5px; flex: 1; }
    button { background: #25d366; color: #fff; border: none; padding: 10px; border-radius: 8px; cursor: pointer; }
    button:hover { background: #1ebe5c; }

    /* Ocultamos secciones hasta que se completen los datos */
    #implantes-section,
    #boton-whatsapp {
      display: none;
    }

    .nota-seguridad {
      font-size: 12px;
      color: #555;
      text-align: center;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <h2>Formulario de Pedido</h2>

  <!-- DATOS DEL ODONT√ìLOGO -->
  <div class="section">
    <h3>Datos del odont√≥logo</h3>
    <input type="text" placeholder="Nombre" id="nombre"><br><br>
    <input type="text" placeholder="Apellido" id="apellido"><br><br>
    <input type="text" placeholder="DNI" id="dni"><br><br>
    <input type="text" placeholder="Matr√≠cula profesional" id="matricula"><br><br>
    <select id="provincia">
      <option value="">Seleccionar provincia</option>
      <option>Buenos Aires</option>
      <option>C√≥rdoba</option>
      <option>Santa Fe</option>
      <option>Mendoza</option>
      <option>Entre R√≠os</option>
    </select><br><br>
    <input type="text" placeholder="Localidad" id="localidad">
  </div>

  <!-- SECCI√ìN IMPLANTES -->
  <div class="section" id="implantes-section">
    <h3>Implantes</h3>
    <div id="implantes-list"></div>
    <button type="button" onclick="agregarImplante()">+ Agregar Implante</button>
  </div>

  <!-- BOT√ìN ENVIAR -->
  <button id="boton-whatsapp" onclick="enviarPedido()">Enviar por WhatsApp</button>

  <p class="nota-seguridad">
    üîí Tu informaci√≥n se procesa de forma segura. El pedido se genera localmente y se env√≠a cifrado por WhatsApp.
  </p>

  <script>
    // ‚úÖ Estructura completa de sistemas y medidas
    const sistemas = {
      "Hex√°gono Interno": [
        "√ò3.0 x 6.5 mm", "√ò3.0 x 8 mm", "√ò3.0 x 10 mm", "√ò3.0 x 11.5 mm", "√ò3.0 x 13 mm", "√ò3.0 x 16 mm",
        "√ò3.75 x 6.5 mm", "√ò3.75 x 8 mm", "√ò3.75 x 10 mm", "√ò3.75 x 11.5 mm", "√ò3.75 x 13 mm", "√ò3.75 x 16 mm",
        "√ò4.2 x 6.5 mm", "√ò4.2 x 8 mm", "√ò4.2 x 10 mm", "√ò4.2 x 11.5 mm", "√ò4.2 x 13 mm", "√ò4.2 x 16 mm",
        "√ò5.0 x 6.5 mm", "√ò5.0 x 8 mm", "√ò5.0 x 10 mm", "√ò5.0 x 11.5 mm", "√ò5.0 x 13 mm", "√ò5.0 x 16 mm"
      ],

      "Hex√°gono Externo": {
        "√ò3.30 (Plataforma √ò3.4)": ["8.5 mm", "10 mm", "11.5 mm", "13 mm", "15 mm"],
        "√ò3.75 (Plataforma √ò4.1)": ["8.5 mm", "10 mm", "11.5 mm", "13 mm", "15 mm"],
        "√ò4.0 (Plataforma √ò4.1)": ["6.0 mm", "8.5 mm", "10 mm", "11.5 mm", "13 mm", "15 mm"],
        "√ò5.0 (Plataforma √ò5.0)": ["8.5 mm", "10 mm", "11.5 mm", "13 mm", "15 mm"]
      },

      "Cono Morse": ["√ò3.5 x 11.5 mm", "√ò4.0 x 13 mm"],
      "Monopieza": ["√ò3.0 x 10 mm", "√ò3.5 x 13 mm"],
      "Monopieza Basal": ["√ò3.5 x 10 mm", "√ò4.0 x 12 mm"],
      "Compresivo Multiunit": ["√ò3.75 x 10 mm", "√ò4.0 x 13 mm"],

      "Minipilares": {
        "Hex√°gono Interno": ["H1", "H2", "H3", "H4", "H5"],
        "Hex√°gono Externo": ["H1", "H2", "H3", "H4", "H5"],
        "Cono Morse": ["H0.8", "H1.5", "H2.5", "H3.5", "H4.5", "H5.5"]
      }
    };

    // Mostrar secciones cuando los campos est√©n completos
    const campos = ["nombre", "apellido", "dni", "matricula", "provincia", "localidad"];
    campos.forEach(id => {
      document.getElementById(id).addEventListener("input", verificarCampos);
    });

    function verificarCampos() {
      const completos = campos.every(id => document.getElementById(id).value.trim() !== "");
      const implantesSection = document.getElementById("implantes-section");
      const botonWhatsApp = document.getElementById("boton-whatsapp");

      if (completos) {
        implantesSection.style.display = "block";
        botonWhatsApp.style.display = "block";
      } else {
        implantesSection.style.display = "none";
        botonWhatsApp.style.display = "none";
      }
    }

    // Funci√≥n para agregar implante
    function agregarImplante() {
      const div = document.createElement("div");
      div.classList.add("item");

      const selectSistema = document.createElement("select");
      selectSistema.innerHTML = "<option value=''>Sistema</option>";
      for (let s in sistemas) {
        selectSistema.innerHTML += `<option value="${s}">${s}</option>`;
      }

      const selectSubtipo = document.createElement("select");
      selectSubtipo.innerHTML = "<option value=''>Subtipo</option>";
      selectSubtipo.style.display = "none";

      const selectMedida = document.createElement("select");
      selectMedida.innerHTML = "<option value=''>Medida</option>";

      selectSistema.addEventListener("change", () => {
        selectMedida.innerHTML = "<option value=''>Medida</option>";
        selectSubtipo.style.display = "none";

        const sistemaSeleccionado = sistemas[selectSistema.value];

        if (typeof sistemaSeleccionado === "object" && !Array.isArray(sistemaSeleccionado)) {
          // Es un objeto (como Hex√°gono Externo o Minipilares)
          selectSubtipo.style.display = "inline-block";
          selectSubtipo.innerHTML = "<option value=''>Subtipo</option>";
          for (let subtipo in sistemaSeleccionado) {
            selectSubtipo.innerHTML += `<option value="${subtipo}">${subtipo}</option>`;
          }
        } else {
          // Es un array normal
          sistemaSeleccionado.forEach(m => {
            selectMedida.innerHTML += `<option value="${m}">${m}</option>`;
          });
        }
      });

      selectSubtipo.addEventListener("change", () => {
        selectMedida.innerHTML = "<option value=''>Medida</option>";
        const sistemaSeleccionado = sistemas[selectSistema.value];
        const medidas = sistemaSeleccionado[selectSubtipo.value];
        medidas.forEach(m => {
          selectMedida.innerHTML += `<option value="${m}">${m}</option>`;
        });
      });

      const inputCantidad = document.createElement("input");
      inputCantidad.type = "number";
      inputCantidad.placeholder = "Cantidad";
      inputCantidad.min = 1;

      div.appendChild(selectSistema);
      div.appendChild(selectSubtipo);
      div.appendChild(selectMedida);
      div.appendChild(inputCantidad);

      document.getElementById("implantes-list").appendChild(div);
    }

    // Enviar pedido por WhatsApp
    function enviarPedido() {
      const nombre = document.getElementById("nombre").value;
      const apellido = document.getElementById("apellido").value;
      const dni = document.getElementById("dni").value;
      const matricula = document.getElementById("matricula").value;
      const provincia = document.getElementById("provincia").value;
      const localidad = document.getElementById("localidad").value;

      let mensaje = `üÜï Nuevo Pedido Bio-Fix\n`;
      mensaje += `üë§ Nombre: ${nombre} ${apellido}\n`;
      mensaje += `ü™™ DNI: ${dni}\n`;
      mensaje += `üìÑ Matr√≠cula: ${matricula}\n`;
      mensaje += `üìç Provincia: ${provincia}, Localidad: ${localidad}\n`;
      mensaje += "--------------------\n";

      document.querySelectorAll("#implantes-list .item").forEach(item => {
        const sistema = item.querySelector("select:nth-child(1)").value;
        const subtipo = item.querySelector("select:nth-child(2)").value;
        const medida = item.querySelector("select:nth-child(3)").value;
        const cantidad = item.querySelector("input").value;

        if (sistema && medida && cantidad) {
          if (subtipo) {
            mensaje += `ü¶∑ ${sistema} - ${subtipo}: ${medida} x${cantidad}\n`;
          } else {
            mensaje += `ü¶∑ ${sistema}: ${medida} x${cantidad}\n`;
          }
        }
      });

      const vendedores = ["5491123456789"]; // ‚ö†Ô∏è Cambiar por tu n√∫mero real
      const link = `https://wa.me/${vendedores[0]}?text=${encodeURIComponent(mensaje)}`;
      window.open(link, "_blank");
    }
  </script>
</body>
</html>
